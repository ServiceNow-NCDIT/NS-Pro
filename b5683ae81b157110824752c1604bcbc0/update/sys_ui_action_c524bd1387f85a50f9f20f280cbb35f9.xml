<?xml version="1.0" encoding="UTF-8"?><record_update sys_domain="global" table="sys_ui_action">
    <sys_ui_action action="INSERT_OR_UPDATE">
        <action_name>sysverb_update_and_stay</action_name>
        <active>true</active>
        <client>true</client>
        <client_script_v2><![CDATA[function onClick(g_form) {

}]]></client_script_v2>
        <comments/>
        <condition>javascript: new x_g_sonc_ns_pro.core_nspro_conditions().newCreateNSProTasks(current)</condition>
        <form_action>true</form_action>
        <form_button>true</form_button>
        <form_button_v2>false</form_button_v2>
        <form_context_menu>false</form_context_menu>
        <form_link>false</form_link>
        <form_menu_button_v2>false</form_menu_button_v2>
        <form_style>unstyled</form_style>
        <format_for_configurable_workspace>false</format_for_configurable_workspace>
        <hint/>
        <isolate_script>true</isolate_script>
        <list_action>false</list_action>
        <list_banner_button>false</list_banner_button>
        <list_button>false</list_button>
        <list_choice>false</list_choice>
        <list_context_menu>false</list_context_menu>
        <list_link>false</list_link>
        <list_save_with_form_button>false</list_save_with_form_button>
        <list_style/>
        <messages/>
        <name>Create NSPro Tasks</name>
        <onclick>selectionDialog()</onclick>
        <order>100</order>
        <script><![CDATA[function selectionDialog() {

    var modalName = "multiSelectAction";
    var modalTitle = 'Create NSPro Tasks';
    var modalContent;

    var contentObj = {};
    contentObj.id = "createNSPROTaskMethod";
    contentObj.title = "Select NSPro Task Type to Create:";

    var options = [];
    var option = {};
    option.optionValue = "createFieldServiceRequest";
    option.optionText = "Field Services Request";
    options.push(option);
    option = {};
    option.optionValue = "createMonitoringRequest";
    option.optionText = "Monitoring Request";
    options.push(option);
    option = {};
    option.optionValue = "createBillingRequest";
    option.optionText = "Billing Request";
    options.push(option);
    option = {};
    option.optionValue = "createGenericRequest";
    option.optionText = "Generic Request";
    options.push(option);

    contentObj.options = options;

    var modals = new GlideAjax('x_g_sonc_ns_pro.core_nspro_modals_ajax');
    modals.addParam('sysparm_name', 'constructMultiSelectContent');
    modals.addParam('sysparm_contentObjString', JSON.stringify(contentObj));
    modals.getXMLAnswer(getResponse);

    function getResponse(response) {
        var answer = JSON.parse(response);
        if (answer.status != 'success') {
            alert("Error Occured " + answer.message);

        } else {
            modalContent = answer.message;
            //alert(modalContent);
            var gm = new GlideModal(modalName);
            gm.setTitle(modalTitle);
            gm.renderWithContent(modalContent);

            top.window.multiActionCancel = function() {
                gm.destroy();
                return;
            };

            //We'll use the windows object to ensure our code is accessible from the modal dialog
            top.window.multiActionSubmit = function(thisButton, thisAction) {

                //Close the glide modal dialog window
                gm.destroy();

                //Submit to the back-end
                if (thisButton == 'OK') {
                    var shortDescription;
                    var telcoOrder = '^telco_order=' + g_form.getValue('telco_order');
                    var taskType;
                    var typeRequest = '^type_request=' + g_form.getValue('type_request');
                    var site = "^site=" + g_form.getValue('site');
                    var location = '^location=' + g_form.getValue('location');
                    var serviceCode = "^service_code=" + g_form.getValue('service_code');
                    var networkServiceCategory = '^network_service_category=' + g_form.getValue('network_service_category');
                    var networkServiceSubCategory = '^network_service_subcategory=' + g_form.getValue('network_service_subcategory');
                    var assignmentGroup;
                    var wanCpePortsRequired = '^wan_cpe_ports_required=' + g_form.getValue('wan_cpe_ports_required');
                    var wanCircuitTypeJack = '^wan_circuit_type_jack=' + g_form.getValue('wan_circuit_type_jack');
                    var assignedWanService = '^assigned_wan_service=' + g_form.getValue('assigned_wan_service');
                    var requestedFor = '^requested_for=' + g_form.getValue('requested_for');
                    var demarcLocation = '^demarc_location=' + g_form.getValue('demarc_location');
                    var telcoProvider = '^telco_provider=' + g_form.getValue('telco_provider');
                    var telcoOrderContact = '^telco_order_contact=' + g_form.getValue('telco_order_contact');
                    var telcoOrderEmail = '^telco_order_email=' + g_form.getValue('telco_order_email');
                    var assignedPop = '^assigned_pop=' + g_form.getValue('assigned_pop');
                    var assignedPe = '^assigned_pe=' + g_form.getValue('assigned_pe');
                    var assignedPePort = '^assigned_pe_port=' + g_form.getValue('assigned_pe_port');
                    var circuit = '^circuit=' + g_form.getValue('circuit');
                    var circuitOrderRequesType = '^circuit_order_request_type=' + g_form.getValue('circuit_order_request_type');
                    var speed = '^speed=' + g_form.getValue('speed');
                    var netplusCac = '^netplus_cac=' + g_form.getValue('netplus_cac');
                    var requiredWanCpeCount = '^required_wan_cpe_count=' + g_form.getValue('required_wan_cpe_count');
                    var selectedAssetSerialNumbers = '^selected_asset_serial_numbers=' + g_form.getValue('selected_asset_serial_numbers');
                    var cpeModelCode = '^cpe_model_code=' + g_form.getValue('cpe_model_code');
                    var cpeModelsRequired = '^cpe_models_required=' + g_form.getValue('cpe_models_required');
                    var requiredWanModels = '^required_wan_models=' + g_form.getValue('required_wan_models');
                    var selectedAssets = '^selected_assets=' + g_form.getValue('selected_assets');

                    var formTitle;
                    var gmf = new GlideModalForm(formTitle, 'x_g_sonc_ns_pro_nspro_tasks');


                    if (thisAction == "createFieldServiceRequest") {

                        formTitle = "Create Field Services Task";
						gmf.setTitle(formTitle);
                        assignmentGroup = '^assignment_group=5755cd0ddb98630065fbf482ba9619d5';
                        taskType = '^task_type=field_services';
                        shortDescription = 'short_description=Field Services Site Install/Turnup';

                        gmf.setPreference('sysparm_query', shortDescription + telcoOrder + taskType + typeRequest + site + serviceCode + networkServiceCategory + networkServiceSubCategory + assignmentGroup + location + wanCpePortsRequired + wanCircuitTypeJack + assignedWanService + requestedFor + demarcLocation + telcoProvider + telcoOrderContact + telcoOrderEmail + assignedPop + assignedPe + assignedPePort + circuit + circuitOrderRequesType + speed + netplusCac + requiredWanCpeCount + selectedAssetSerialNumbers + cpeModelCode + cpeModelsRequired + requiredWanModels + selectedAssets);

                        gmf.setSysID("-1");

                        gmf.render();
                    } else if (thisAction == "createMonitoringRequest") {

                        formTitle = "Create Monitoring Task";
						gmf.setTitle(formTitle);
                        assignmentGroup = '^assignment_group=4c33dda04764d65040fd43ff336d4379'; //Enterprise Monitoring
                        taskType = '^task_type=enterprise_monitoring';
                        shortDescription = 'short_description=Add to Monitoring';

                        gmf.setPreference('sysparm_query', shortDescription + telcoOrder + taskType + typeRequest + site + serviceCode + networkServiceCategory + networkServiceSubCategory + assignmentGroup + location + wanCpePortsRequired + wanCircuitTypeJack + assignedWanService + requestedFor + demarcLocation + telcoProvider + telcoOrderContact + telcoOrderEmail + assignedPop + assignedPe + assignedPePort + circuit + circuitOrderRequesType + speed + netplusCac + requiredWanCpeCount + selectedAssetSerialNumbers + cpeModelCode + cpeModelsRequired + requiredWanModels + selectedAssets);

                        gmf.setSysID("-1");

                        gmf.render();


                    } else if (thisAction == "createBillingRequest") {

                        formTitle = "Create Billing Task";
						gmf.setTitle(formTitle);
                        assignmentGroup = '^assignment_group=0355cd0ddb98630065fbf482ba961932'; //Billing Support Services
                        taskType = '^task_type=billing';
                        shortDescription = 'short_description=Modify Billing Task';

                        gmf.setPreference('sysparm_query', shortDescription + telcoOrder + taskType + typeRequest + site + serviceCode + networkServiceCategory + networkServiceSubCategory + assignmentGroup + location + wanCpePortsRequired + wanCircuitTypeJack + assignedWanService + requestedFor + demarcLocation + telcoProvider + telcoOrderContact + telcoOrderEmail + assignedPop + assignedPe + assignedPePort + circuit + circuitOrderRequesType + speed + netplusCac + requiredWanCpeCount + selectedAssetSerialNumbers + cpeModelCode + cpeModelsRequired + requiredWanModels + selectedAssets);

                        gmf.setSysID("-1");

                        gmf.render();


                    } else if (thisAction == "createGenericRequest") {

                        formTitle = "Create Generic Task";
						gmf.setTitle(formTitle);
                        //assignmentGroup = '^assignment_group=4c33dda04764d65040fd43ff336d4379'; //Enterprise Monitoring
                        taskType = '^task_type=generic';
                        shortDescription = 'short_description=Generic Task';

                        gmf.setPreference('sysparm_query', shortDescription + telcoOrder + taskType + typeRequest + site + serviceCode + networkServiceCategory + networkServiceSubCategory + assignmentGroup + location + wanCpePortsRequired + wanCircuitTypeJack + assignedWanService + requestedFor + demarcLocation + telcoProvider + telcoOrderContact + telcoOrderEmail + assignedPop + assignedPe + assignedPePort + circuit + circuitOrderRequesType + speed + netplusCac + requiredWanCpeCount + selectedAssetSerialNumbers + cpeModelCode + cpeModelsRequired + requiredWanModels + selectedAssets);

                        gmf.setSysID("-1");

                        gmf.render();


                        //Regular ServiceNow form submission
                        //gsftSubmit(null, g_form.getFormElement(), 'sysverb_update_and_stay');
                    }
                }






                return false; //prevents the form from submitting when the dialog first loads
            }; // end of else response
        }
	}
}]]></script>
        <show_insert>true</show_insert>
        <show_multiple_update>false</show_multiple_update>
        <show_query>false</show_query>
        <show_update>true</show_update>
        <sys_class_name>sys_ui_action</sys_class_name>
        <sys_created_by>admglfry</sys_created_by>
        <sys_created_on>2024-09-27 18:15:11</sys_created_on>
        <sys_domain>global</sys_domain>
        <sys_domain_path>/</sys_domain_path>
        <sys_id>c524bd1387f85a50f9f20f280cbb35f9</sys_id>
        <sys_mod_count>65</sys_mod_count>
        <sys_name>Create NSPro Tasks</sys_name>
        <sys_overrides/>
        <sys_package display_value="NS Pro" source="x_g_sonc_ns_pro">b5683ae81b157110824752c1604bcbc0</sys_package>
        <sys_policy/>
        <sys_scope display_value="NS Pro">b5683ae81b157110824752c1604bcbc0</sys_scope>
        <sys_update_name>sys_ui_action_c524bd1387f85a50f9f20f280cbb35f9</sys_update_name>
        <sys_updated_by>admglfry</sys_updated_by>
        <sys_updated_on>2024-10-16 11:34:14</sys_updated_on>
        <table>x_g_sonc_ns_pro_nspro_tasks</table>
        <ui11_compatible>true</ui11_compatible>
        <ui16_compatible>false</ui16_compatible>
    </sys_ui_action>
</record_update>
